<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PortisApp - Registrarse</title>
    <link rel="stylesheet" href="SignIn.css">
</head>
<body>
    <div class="card-container">
        <div class="card">
            <h1>Registro de Usuario</h1>

            <form id="signInForm">
                <div class="input-group">
                    <input type="text" id="username" placeholder="Usuario (Ej: nuevo_usuario)" required>
                </div>
                
                <div class="input-group">
                    <input type="password" id="password" placeholder="Contraseña" required>
                </div>
                
                <div class="input-group">
                    <input type="password" id="confirmPassword" placeholder="Confirmar Contraseña" required>
                </div>
                
                <button type="button" id="signInBtn" class="btn-registro">Registrarse</button>
            </form>
            
            <div id="messageBox" class="message-box hidden" role="alert" aria-live="assertive"></div>

            <p class="login-text">
                ¿Ya tienes una cuenta? 
                <a href="#" id="loginLink" class="login-link">Iniciar Sesión</a>
            </p>

        </div>
    </div>

    <script type="module">
        // Importaciones de Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
        
        // --- Configuración de Firebase ---
        const firebaseConfig = {
            apiKey: "AIzaSyD_tC3KaK3UVyNOPiSsnI0s5k8Cd_qFJpg",
            authDomain: "portisapp.firebaseapp.com",
            projectId: "portisapp",
            storageBucket: "portisapp.firebasestorage.app",
            messagingSenderId: "38313359657",
            appId: "1:38313359657:web:ae73a0f8f7556bed92df38",
            measurementId: "G-HQ29Y8Z2DY"
        };
        
        // Inicializar Firebase y exportar instancias
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        
        // Autenticación anónima para permitir el acceso a Firestore
        signInAnonymously(auth).catch(error => console.error("Error en autenticación anónima:", error));

        // Hacer las referencias globales para SignIn.js
        window.db = db;
        window.collection = collection;
        window.addDoc = addDoc; 
        window.query = query;
        window.where = where;
        window.getDocs = getDocs;
    </script>
    
    <script src="SignIn.js"></script> 
</body>
</html>